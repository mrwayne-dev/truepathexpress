RewriteEngine On

# ---------------------------------
# REMOVE TRAILING SLASH
# ---------------------------------
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ /$1 [R=301,L]

# =================================
# ROOT HOME PAGE
# =================================
RewriteRule ^$ pages/public/index.php [L]

# =================================
# ADMIN AUTH ROUTES
# =================================
RewriteRule ^admin\.auth\.login/?$ pages/admin/auth/admin-login.php [L]
RewriteRule ^admin\.auth\.register/?$ pages/admin/auth/admin-register.php [L]
RewriteRule ^admin\.auth\.forgotpassword/?$ pages/admin/auth/admin-forgot-password.php [L]
RewriteRule ^admin\.auth\.resetpassword/?$ pages/admin/auth/admin-reset-password.php [L]

# =================================
# ADMIN DASHBOARD ROUTES
# =================================
RewriteRule ^admin\.dashboard/?$ pages/admin/dashboard.php [L]
RewriteRule ^admin\.packages/?$ pages/admin/packages.php [L]
RewriteRule ^admin\.transactions/?$ pages/admin/transactions.php [L]

# =================================
# PUBLIC PAGES
# =================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9-]+)/?$ pages/public/$1.php [L]

# ============================================
# BROWSER CACHING & COMPRESSION
# ============================================

# Enable Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Cache Static Assets (1 year)
<FilesMatch "\.(jpg|jpeg|png|gif|webp|avif|svg|woff|woff2|ttf|eot|ico|mp4|webm)$">
    Header set Cache-Control "max-age=31536000, public, immutable"
</FilesMatch>

# Cache CSS/JS (1 month, revalidate)
<FilesMatch "\.(css|js)$">
    Header set Cache-Control "max-age=2592000, public, must-revalidate"
</FilesMatch>

# Don't cache HTML/PHP (1 hour max, must revalidate)
<FilesMatch "\.(html|php)$">
    Header set Cache-Control "max-age=3600, public, must-revalidate"
</FilesMatch>

# Remove ETags (redundant with Cache-Control)
Header unset ETag
FileETag None
